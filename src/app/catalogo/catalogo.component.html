<nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
  <div class="container">
    <a href="" class="navbar-brand"><img src="assets/imagenes/logo.png" class="img-fluid" width="100px"/></a>
    <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarsExample07" aria-controls="navbarsExample07" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="navbar-collapse collapse" id="navbarsExample07">
      <ul class="navbar-nav mr-auto">

      </ul>
      <form class="form-inline my-2 my-md-0 d-flex flex-lg-row flex-column align-items-lg-end align-items-end">
          <a  class="app-nav__item text-right puntero" (click)="fsolicitar(solicita)" title="Carrito">
            <span class=" d-sm-inline d-lg-none text-white">Carrito de Compras </span>
            <i class="fa fa-shopping-cart fa-2x text-white"></i>
            <span class="badge badge-warning" *ngIf="cantidadcarrito.cantidad > 0">x{{ cantidadcarrito.cantidad }}</span>
          </a>
          <a *ngIf="localnombre==''" class="app-nav__item text-right puntero " (click)="faccesom(accesom)" title="Iniciar Sesión">
            <span class=" d-sm-inline d-lg-none text-white mr-2">Iniciar Sesión </span>
            <i class="fa fa-user fa-2x text-white"></i>
          </a>
          <a class="app-nav__item text-right puntero " *ngIf="localnombre"  title="Iniciar Sesión">
            <span class="text-white mr-2">Bienvenido: {{ localnombre }} </span>
            <i class="fa fa-user fa-2x text-white d-sm-inline d-lg-none"></i>
          </a>
          <a *ngIf="localnombre" class="app-nav__item text-right puntero " (click)="fsalir()" title="Cerrar Sesion">
            <span class=" d-sm-inline d-lg-none text-white mr-2">Cerrar Sesión </span>
            <i class="fa fa-sign-out fa-2x text-white"></i>
          </a>
      </form>
    </div>
  </div>
</nav>

<div class="container-lg mt-5 pt-5">
    <div class="form-group row justify-content-center">
        <div class="col-md-10 col-sm-12">
          <div class="position-relative mx-auto">
            <input class="form-control border-2 border-secondary w-80 py-3 px-4 rounded-pill" type="texto" [(ngModel)]="buscar"  placeholder="Producto a buscar..." (keyup)="fbuscar()">
            <button type="submit" class="btn btn-primary border-2 border-secondary px-4 position-absolute rounded-pill text-white h-100" style="top: 0; right: 0%;" (click)="limpiar()">Buscar</button>
          </div>
        </div>

        <div class="col-12">
          <h2 for="orden">Rubros: </h2>
        </div>
        <div class="col-md-9 col-sm-12 justify-content-center">
          <ul class="nav nav-pills d-inline-flex text-center mb-5">
              <li class="nav-item">
                <a class="puntero d-flex m-2 py-2 bg-info rounded-pill active" data-bs-toggle="pill" (click)="limpiar(); flistasubrubro()">
                  <h6 class="text-white" style="width: 130px;">Todos los Rubros</h6>
                </a>
              </li>
              <li class="nav-item " *ngFor="let _rubro of rubros">
                <a class="puntero d-flex py-2 m-2 bg-info rounded-pill" data-bs-toggle="pill" (click)="fbuscarrubro(_rubro.rubro); fsubrubro(_rubro.idrubro)">
                  <h6 class="text-white" style="width: 130px;">{{ _rubro.rubro }}</h6>
                </a>
              </li>
          </ul>
        </div>
        <div class="col-md-3 col-sm-12">
          <div class="bg-light ps-3 py-3 rounded d-flex justify-content-between mb-4">
            <label for="orden">Orden: </label>
            <select id="orden" name="fruitlist" class=" custom-select-sm bg-light me-2" form="fruitform">
                <option value="volvo">A-Z (ASC)</option>
                <option value="saab">Z-A (DESC)</option>
                <option value="opel">Reciente</option>
                <option value="audi">Popular</option>
            </select>
        </div>
        </div>
    </div>

    <div class="row">
      <div class="col-md-3 col-sm-12">
        <h3 for="orden">Subrubros: </h3>
        <div class="list-group">
          <a href="#" class="list-group-item list-group-item-action list-group-item-light d-flex justify-content-between align-items-center" *ngFor="let _subrubro of subrubros">
            {{ _subrubro.subrubro }} <span class="badge badge-success badge-pill">14</span>
          </a>
        </div>
      </div>

      <div class="col-md-9 col-sm-12">
        <div class="row">
          <div class="col-md-6 col-lg-6 col-xl-4" *ngFor="let _item of datos; let i = index">
            <div class="rounded position-relative fruite-item tarjeta">
                <div class="fruite-img">
                    <img [src]="ruta+_item.idproducto" class="img-fluid w-100 rounded-top" alt="">
                </div>
                <div class="text-white bg-secondary px-3 py-1 rounded position-absolute" style="top: 10px; left: 10px;">Reactiva TIC</div>
                <div class="p-4 border border-secondary border-top-0 rounded-bottom">
                    <a (click)="fdetalle(_item.idproducto)" class="puntero" title="{{ _item.producto }}"><h4><span class="product">{{ _item.producto }}</span></h4></a>
                    <p class="description">{{ _item.descripcion }}</p>
                    <div class="d-flex justify-content-between flex-lg-wrap">
                        <p class="text-dark fs-5 fw-bold mb-0">{{ _item.precioventa }} Bs.</p>
                    </div><hr>
                    <div class="d-flex justify-content-end flex-lg-wrap">
                        <a (click)="fadicionar(_item.idproducto, 1)" class="btn border border-secondary rounded-pill px-3 text-primary"><i class="fa fa-shopping-cart me-2 text-primary"></i> Añadir al Carrito</a>
                    </div>
                </div>
            </div>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-lg-12" *ngIf="total > cantidad">
            <ngb-pagination
              class="d-flex justify-content-center pagination-rounded"
              [collectionSize]="total"
              [(page)]="pagina"
              [maxSize]="cantidad"
              [pageSize]="12"
              [rotate]="false"
              [ellipses]="false"
              [boundaryLinks]="true"
              (pageChange)="mostrarMas($event)"
            ></ngb-pagination>
          </div>
        </div>
      </div>
    </div>
</div>

<footer class="container-fluid" >
  <p class="app-footer__logo text-center">
    <small>Desarrollado por: SDDPI - DPEIC - REACTIVA TIC &copy; 2022-{{ gestion }} GADOR</small>
  </p>
</footer>

  <ng-template #solicita>
    <div class="modal-header justify-content-between">
      <h4 class="modal-title pull-left">Mi Carrito</h4>
      <i class="fa fa-shopping-cart fa-2x"></i>
    </div>
    <div class="modal-body">
      <div class="row">
        <div class="table-responsive" *ngIf="carritos?.length > 0">
          <table class="table table-sm">
            <thead>
              <tr class="table-primary">
                <th class="text-left">Producto</th>
                <th class="text-center">Precio Unitario</th>
                <th class="text-center">Cantidad</th>
                <th class="text-center">Total</th>
                <th class="text-right">Operaciones</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let _item of carritos; let i = index">
                <td class="text-left">{{ _item.producto.producto }}</td>
                <td class="text-center">{{ _item.producto.precioventa }} Bs.</td>
                <td class="text-center">
                  {{ _item.cantidad }}
                </td>
                <td class="text-center">{{ _item.cantidad*_item.producto.precioventa }} Bs.</td>
                <td class="text-right">
                  <button class="btn btn-sm btn-outline-danger" (click)="feliminar(_item.idproducto)" title="Quitar producto">
                    <i class="fa fa-trash fa-2x"></i>
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="text-center">
            <button class="btn btn-outline-success mr-2" (click)="fprocesa(pedido)" >
              <span><i class="fa fa-cogs"></i> Realizar Compra</span>
            </button>
            <button class="btn btn-outline-secondary mr-2" (click)="fcerrar()">
              <span><i class="fa fa-close"></i> Cerrar</span>
            </button>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="table-responsive" *ngIf="!(carritos?.length > 0)">
          <table class="table table-sm">
            <thead>
              <tr class="table-primary">
                <th class="text-left">Producto</th>
                <th class="text-center">Precio Unitario</th>
                <th class="text-center">Cantidad</th>
                <th class="text-center">Total</th>
                <th class="text-right">Operaciones</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="5" class="text-center"><h3>Tu carrito está vacío</h3></td>
              </tr>
            </tbody>
          </table>
          <div class="text-center" *ngIf="!(carritos?.length > 0)">
            <button class="btn btn-outline-secondary mr-2" (click)="fcerrar()">
              <span><i class="fa fa-close"></i> Cerrar</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </ng-template>

  <ng-template #solicitaproducto>
    <div class="modal-header">
      <h4 class="modal-title pull-left">Mi Carrito</h4>
    </div>
    <div class="modal-body">
      <div class="table-responsive" *ngIf="carritos?.length > 0">
        <div class="table-responsive">
          <table class="table table-sm">
            <thead>
              <tr class="table-primary">
                <th class="text-left">Producto</th>
                <th class="text-right">Cantidad</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let _item of carritos; let i = index">
                <td class="text-left">{{ _item.producto.producto }}</td>
                <td class="text-right">{{ _item.cantidad }}</td>
              </tr>
            </tbody>
          </table>
      </div>
      <div class="coupon-apply mt-5">
          <input type="text" placeholder="Coupon Code">
          <button type="button">Apply Coupon</button>
      </div>
      <div class="row g-4 justify-content-end">
          <div class="col-8"></div>
          <div class="col-sm-8 col-md-7 col-lg-6 col-xl-4">
              <div class="cart-total">
                  <div class="cart-summary">
                      <h1>Cart <span>Total</span></h1>
                      <div class="subtotal">
                          <h5>Subtotal:</h5>
                          <p>$96.00</p>
                      </div>
                      <div class="shipping">
                          <h5>Shipping</h5>
                          <p>Flat rate: $3.00</p>
                          <p>Shipping to Ukraine.</p>
                      </div>
                  </div>
                  <div class="total-amount">
                      <h5>Total</h5>
                      <p>$99.00</p>
                  </div>
                  <button type="button">Proceed Checkout</button>
              </div>
          </div>
      </div>

        <div class="text-center">
          <button class="btn btn-primary mr-2" (click)="fcerrar()">
            <span><i class="fa fa-cogs"></i> Aceptar</span>
          </button>
        </div>
      </div>
      <h3 class="text-center" *ngIf="!(carritos?.length > 0)">
        Tu carrito esta vacío
      </h3>
      <div class="text-center" *ngIf="!(carritos?.length > 0)"></div>
    </div>
  </ng-template>

  <ng-template #empresa>
    <div class="modal-header">
      <h4 class="modal-title pull-left" *ngIf="datosempresa">
        {{ datosempresa.empresa }}
      </h4>
    </div>
    <div class="modal-body">
      <table class="table table-sm">
        <tr>
          <td>Empresa:</td>
          <td>
            <b>{{ datosempresa.empresa }}</b>
          </td>
        </tr>
        <tr>
          <td>Dirección:</td>
          <td>
            <b>{{ datosempresa.direccion }}</b>
          </td>
        </tr>
        <tr>
          <td>Teléfono:</td>
          <td>
            <b>{{ datosempresa.telefono }}</b>
          </td>
        </tr>
        <tr>
          <td>Celular:</td>
          <td>
            <b>{{ datosempresa.celular }}</b>
          </td>
        </tr>
        <tr>
          <td>Correo Electrónico:</td>
          <td>
            <b>{{ datosempresa.correo }}</b>
          </td>
        </tr>
      </table>
      <div class="text-center">
        <button class="btn btn-primary mr-2" (click)="fcerrar()">
          <span><i class="fa fa-close"></i> Cerrar</span>
        </button>
      </div>
    </div>
  </ng-template>


<ng-template #pedido>
  <div class="modal-header">
      <h4 class="modal-title pull-left"><i class="fa fa-edit"></i> Proceso de solicitud</h4>
      <div class="alert alert-info" role="alert">
          Estimado cliente Los campos remarcados con * son necesarios.
      </div>
  </div>
  <div class="modal-body">
      <form [formGroup]="formulario" (ngSubmit)="faceptar()">
          <div class="form-group">
              <label>Nombre completo <span class="text-danger"><b>*</b></span></label>
              <input type="text" class="form-control" formControlName="primerapellido" [class.is-invalid]="f.primerapellido.errors && f.primerapellido.touched" />
              <small *ngIf="f.primerapellido.errors&& f.primerapellido.touched" class="text-danger">
                El dato es obligatorio y solo permite letras
              </small>
          </div>
          <div class="form-group">
              <label>Celular <span class="text-danger"><b>*</b></span></label>
              <input type="number" class="form-control" formControlName="celular" [class.is-invalid]="f.celular.errors && f.celular.touched" />
              <small *ngIf="f.celular.errors && f.celular.touched" class="text-danger">
              El dato es obligatorio y solo permite numeros de celulares
              </small>
          </div>
          <div class="form-group">
              <label>Correo </label>
              <input type="email" class="form-control" formControlName="correo" [class.is-invalid]="f.correo.errors && f.correo.touched" />
              <small *ngIf="f.correo.errors && f.correo.touched" class="text-danger">
              El dato es obligatorio
              </small>
          </div>
          <div class="text-center">
              <button type="submit" class="btn btn-success m-2" [disabled]="!formulario.valid">
                <i class="fa fa-save"></i> Grabar
            </button>
              <button type="button" class="btn btn-danger" (click)="fcancelar()">
                <i class="fa fa-times"></i> Cancelar
            </button>
          </div>
      </form>
  </div>
</ng-template>

<ng-template #accesom>
  <div class="modal-header">
      <h4 class="modal-title pull-left"><i class="fa fa-edit"></i> Acceso al sistema</h4>
      <div class="alert alert-info" role="alert">
          Estimado cliente Los campos remarcados con * son necesarios.
      </div>
  </div>
  <div class="modal-body">
      <form [formGroup]="formulariom" (ngSubmit)="faceptarm()">
          <div class="form-group">
              <label>Celular <span class="text-danger"><b>*</b></span></label>
              <input type="number" class="form-control" formControlName="celular" [class.is-invalid]="fm.celular.errors && fm.celular.touched" />
              <small *ngIf="fm.celular.errors && fm.celular.touched" class="text-danger">
              El dato es obligatorio y solo permite numeros de celulares
              </small>
          </div>
          <div class="form-group">
              <label>Clave de acceso <span class="text-danger"><b>*</b></span></label>
              <input type="password" class="form-control" formControlName="clave" [class.is-invalid]="fm.clave.errors && fm.clave.touched" />
              <small *ngIf="fm.clave.errors && fm.clave.touched" class="text-danger">
              El dato es obligatorio
              </small>
          </div>
          <div class="text-center">
              <button type="submit" class="btn btn-success m-2" [disabled]="!formulariom.valid">
                <i class="fa fa-sign-in"></i> Ingresar
            </button>
              <button type="button" class="btn btn-danger" (click)="fcancelar()">
                <i class="fa fa-times"></i> Cancelar
            </button>
          </div>
      </form>
  </div>
</ng-template>
